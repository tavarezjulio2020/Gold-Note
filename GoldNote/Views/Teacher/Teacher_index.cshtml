@* Teacher_index.cshtml (Updated Structure) *@
@* Assuming this view receives List<StudentDashboardItem> as its Model *@

<div class="text-center">
    <h1 class="display-4 gold">@ViewBag.Username</h1>
    <div> 
       <h2>Class Code: @ViewBag.ClassCode.ClassCode</h2>
    </div>
</div>

<h2>Your Students</h2>

<table class="table table-hover student-list-table">
    <thead>
        <tr>
            <th>Student Name</th>
            <th>Instrument</th>
            <th>Practice time This Week </th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody id="studentTableBody">

    </tbody>
</table>

@section Scripts {
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function () {
            getStudents();
        });

        function getStudents(){
           $.ajax({
                     url: '/Teacher/GetMyStudents',
              datatype:'json',
              type: 'GET',
              success: function(data) {
                 console.log(data);
                 var html = "";
                 for(let i=0; i<data.length; i++){
                    html += "<tr><td>" +data[i].studentName+"</td><td>" + data[i].instrumentName + "</td><td>"+ timeDisplay(data[i].secondsPracticed) +"</td><td> Assingments </td></tr>";
                 }
                 $('#studentTableBody').html(html);
              }
           });
        }

        function timeDisplay(totalSeconds) {
            // Ensure we start with a positive integer
            if (typeof totalSeconds !== 'number' || totalSeconds < 0) {
                return "0s";
            }

            var hours;
            var minutes;
            var seconds;

            seconds = totalSeconds % 60;
            var remainingMinutes = Math.floor(totalSeconds / 60); 
            minutes = remainingMinutes % 60;
            hours = Math.floor(remainingMinutes / 60); 
            var parts = [];

            if (hours > 0) {
                parts.push(hours + 'h');
            }

            if (minutes > 0) {
                parts.push(minutes + 'm');
            }

            // Only display seconds if there's no hour or minute component, OR if it's explicitly non-zero
            if (seconds > 0 || (totalSeconds === 0 && parts.length === 0)) {
                parts.push(seconds + 's');
            }

            return parts.join(' ');
        }
    </script>
}